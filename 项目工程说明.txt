1.Releaseæ˜¯ç”¨çš„DIDIVoiceRecognitionClient_Publish.hï¼›

2.ISCForOneProjecté¡¹ç›®gitåœ°å€ï¼šhttps://git.xiaojukeji.com/zhangkaiming/ISCForOneProjectï¼Œæ˜¯é›†æˆä¸­é—´å±‚å’ŒASR SDKçš„podå·¥ç¨‹ï¼Œä¸éœ€è¦ç¼–è¯‘ï¼Œæ˜¯é€šè¿‡podå¯¼å…¥å·¥ç¨‹ï¼›

3.è·å–è¯­éŸ³éŸ³é‡çš„æ¥å£ï¼š[[DIDIVoiceRecognitionClient sharedInstance] getCurrentDBLevelMeter]ï¼›

4ã€DiSpecialDriveré¡¹ç›®çš„æœåŠ¡ä¸­å¿ƒH5ä¸ºKFOnlineWebViewControllerï¼Œåœ¨registBridgeæ–¹æ³•ä¸­è°ƒç”¨å½•éŸ³æ¨¡å—ï¼Œå”¤èµ·KefuMsgClientç±»çš„ç›¸å…³æ¥å£ï¼Œå³@â€œstartRecord"ï¼ˆ[kefuClient startRecWithPid:data]ï¼‰ä¸@"endRecord"ï¼ˆ[kefuClient finishSpeak]ï¼‰ï¼›

5.[kefuClient startRecWithPid:data]ä¸­dataçš„æ•°æ®ç»“æ„ä¸º
{
    chatInfo =     {
        businessType = 1;
        cell = 18800000004;
        cityId = 1;
        message = "";
        mid = "6220bd3e-f003-4a6b-8f57-64ac0b0afcdc";
        msgType = 0;
        orderId = 0;
        roleType = 3;
        skillType = common;
        source = "-1";
        traceId = "1c9a629d-d982-4139-8e43-24f143931d20";
        uid = 564069099110401;
    };
    pid = 10001;
	newVoice = 0; //1ä¸ºæ–°ç‰ˆ0ä¸ºæ—§ç‰ˆ
}
å‡¯é“­ï¼Œæˆ‘çœ‹ä¹‹å‰å¸æœºç«¯æŠŠå°æµé‡çš„åˆ¤æ–­æ‰”åˆ°KefuMsgClienté‡Œåˆ¤æ–­äº†ã€‚

6.æŸ¥çœ‹.aé™æ€åº“æ”¯æŒçš„CPUå‹å·å‘½ä»¤ï¼šlipo -info XXX.a
åˆå¹¶æ¨¡æ‹Ÿå™¨ä¸çœŸæœºçš„.aåº“ï¼Œå‘½ä»¤ï¼š
lipo -create XXX/iphoneos/XXX.a XXX/iphonesimulator/XXX.a  -output XXX/iOS/XXX.a
å…¶ä¸­XXX/iphoneos/XXX.aä¸ºçœŸæœºåº“ï¼ŒXXX/iphonesimulator/XXX.aä¸ºæ¨¡æ‹Ÿå™¨åº“ï¼Œ-output XXX/iOS/XXX.aä¸ºä¸¤ä¸ªåº“åˆå¹¶åå­˜æ”¾çš„è·¯å¾„
lipo -create Release-iphoneos/libDIDIKeFuClient.a Release-iphonesimulator/libDIDIKeFuClient.a -output Release-iOS/libDIDIKeFuClient.a
/Users/guoliting/Library/Developer/Xcode/DerivedData/DDASRClientSample-dgsitlqlrfjkyrcxejallpopihli/Build/Products
lipo -create Release-iphoneos/libDDVoiceRecognitionClient.a Release-iphonesimulator/libDDVoiceRecognitionClient.a -output Release-iOS/libDDVoiceRecognitionClient.a

@æ–‡å½¬ @Snowâ„ @éƒ‘æ™®äº¨ @Chelsea  @å¨Ÿ å„¿ğŸ’ƒ ğŸ’  https://www.pgyer.com/AutomaticSpeechRec æœ€æ–°ç‰ˆå·²å‘å¸ƒï¼Œéœ€è¦æµ‹è¯•çš„åŒå­¦æ‰‹åŠ¨æ›´æ–°ä¸‹ï¼ŒSDKä½“ç§¯ç¼©å‡ï¼ŒåŠŸèƒ½æ²¡å½±å“ã€‚

7.åœ¨Demoé¡¹ç›®é‡Œå¢åŠ Podfileæ–‡ä»¶ï¼Œé›†æˆISCProjectåº“ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
ä½¿ç”¨ä»“åº“çš„æŸä¸ªtag:
target 'Waver' do
    platform:ios, '7.0'
    pod 'ISCProject', :git => "git@git.xiaojukeji.com:zhangkaiming/ISCForOneProject.git", :tag => "0.2.1"
end
ä½¿ç”¨ä»“åº“çš„å…¶ä»–åˆ†æ”¯:
target 'Waver' do
    platform:ios, '7.0'
    pod 'ISCProject', :git => "git@git.xiaojukeji.com:zhangkaiming/ISCForOneProject.git", :branch => 'develop'
end

8.é›†æˆISCProjectåº“åï¼Œç¼–è¯‘æŠ¥é”™ï¼š"vtable for __cxxabiv1::__class_type_info", referenced from:
      typeinfo for CAXException in libDDVoiceRecognitionClient.a(DIDIVRDBLevelMeterListener.o)
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation)
è§£å†³æ–¹æ¡ˆï¼š
é‡åˆ°è¿™æ ·çš„é—®é¢˜ä¸»è¦æ˜¯ç¬¬ä¸‰æ–¹åº“å¯¼å…¥çš„é…ç½®ä¸å¯¹ï¼Œé™æ€åº“ä¸­é‡‡ç”¨ObjectC++å®ç°ï¼Œå› æ­¤éœ€è¦æ‚¨ä¿è¯æ‚¨å·¥ç¨‹ä¸­è‡³å°‘æœ‰ä¸€ä¸ª.mmåç¼€çš„æºæ–‡ä»¶(æ‚¨å¯ä»¥å°†ä»»æ„ä¸€ä¸ª.måç¼€çš„æ–‡ä»¶æ”¹åä¸º.mm)ï¼Œæˆ–è€…åœ¨å·¥ç¨‹å±æ€§ä¸­æŒ‡å®šç¼–è¯‘æ–¹å¼ï¼Œå³å°†Xcodeçš„Project -> Edit Active Target -> Build -> GCC4.2 - Language -> Compile Sources Asè®¾ç½®ä¸º"Objective-C++"

9.æ–°ç‰ˆå‘å¸ƒæµç¨‹ï¼šç¼–è¯‘å¥½æ–°çš„è¯†åˆ«åº“ï¼Œå¢åŠ æ–°UIåæŠŠç›¸å…³å¤´æ–‡ä»¶å’Œ.aåº“æ›¿æ¢åˆ°ISCForOneProjectå·¥ç¨‹ï¼Œpushåˆ°ä»£ç åº“é‡Œï¼Œå¸æœºç«¯pod updateåå°±å¯ä»¥è°ƒï¼›

10.0719åœ¨çº¿å®¢æœéœ€æ±‚ç–‘é—®
ï¼ˆ1ï¼‰ç»“æŸå½•éŸ³çš„äº¤äº’æ–¹å¼ï¼Ÿ
ï¼ˆ2ï¼‰å½•éŸ³æç¤ºéŸ³ç±»å‹ï¼š
å¼€å§‹ iOS:record_start.caf
ç»“æŸ iOS:record_end.caf
å‡ºé”™ iOS:record_fail.caf
é™„ä»¶æ˜¯ç°æœ‰çš„å£°éŸ³æ–‡ä»¶
ï¼ˆ3ï¼‰ç‚¹æŒ‰å½•éŸ³å›¾æ ‡åˆ°æ³¢çº¹çš„äº¤äº’æ–¹å¼ï¼Ÿæ˜ç¡®H5ä¸Nativeå„è‡ªè¦å®ç°çš„éƒ¨åˆ†ã€‚

11.å½•éŸ³æç¤ºéŸ³
æç¤ºéŸ³ç›®å½•ï¼š/Users/guoliting/didichuxing/asr-ios-sdk/ios-sdk/DDASRClientSample/libDDASRClient/DDASRClientResources/Tone
å¼€å¯æç¤ºéŸ³ï¼š[[DIDIVoiceRecognitionClient sharedInstance] setPlayTone:EVoiceRecognitionPlayTonesRecStart isPlay:YES];
Demoä½¿ç”¨æ—¶éœ€è¦å°†DDASRClientResourcesæ–‡ä»¶å¤¹æ‹·è´è‡³é¡¹ç›®æ‰€åœ¨ç›®å½•ï¼Œæ·»åŠ è‡³å·¥ç¨‹æ—¶æ‰“å¼€Optionsåªå‹¾é€‰Create folder referenceï¼Œè¿™æ ·Demoè¿è¡Œæ—¶çš„AppåŒ…é‡Œå°±ä¼šåŒ…å«DDASRClientResourcesæ–‡ä»¶å¤¹ï¼›

12.è¯­éŸ³è¯†åˆ«å°¾ç‚¹æ£€æµ‹
ç™¾åº¦Androidåœ¨çº¿è¯­éŸ³è¯†åˆ«SDKä½¿ç”¨æ–¹æ³•  http://blog.csdn.net/voicefans/article/details/27345137
è¯­éŸ³æ´»åŠ¨æ£€æµ‹(Voice Activity Detection,VAD)åˆç§°è¯­éŸ³ç«¯ç‚¹æ£€æµ‹,è¯­éŸ³è¾¹ç•Œæ£€æµ‹ã€‚
#define     PARAM_MAX_SP_DURATION       2  //æ§åˆ¶æ¯å¥ä¹‹é—´è¯´è¯çš„æœ€å¤§é™éŸ³æ—¶é—´ï¼Œå•ä½æ¯«ç§’
#define     PARAM_SPEECH_END            9  //ç«¯ç‚¹æ£€æµ‹è¶…æ—¶ï¼Œå•ä½æ¯«ç§’
[[DIDIVREncoder sharedInstance] setParameter: PARAM_MAX_SP_DURATION withValue: 2000];
    [[DIDIVREncoder sharedInstance]setParameter:PARAM_SPEECH_END withValue:35];
// DIDIVoiceRecognitionClientResources/Tone
// DDASRClientResources/Tone
static NSString *kRecordTonePath = @"DDASRClientResources/Tone/";

/var/containers/Bundle/Application/E950D322-76C8-404D-8B10-6A3F3F1261DA/DiSpecialDriver.app/DDASRClientResources/Tone/record_start.caf
/var/mobile/Containers/Data/Application/142E3545-B101-4107-A832-E24C707ED962/Documents/RecordVoice/2016_07_29_17_47_37.mp3

æ”¶åˆ°çš„ç»“æœï¼š{
    "asr_param" =     {
        "err_no" = "-3003";
        error = "get result error";
        idx = 1;
        sid = "2742AADC-AED6-42D5-AAD2-D8D13551AEB2";
    };
}

13.libDDVoiceRecognitionClient.aæ›¿æ¢ä¸ºDebugç‰ˆï¼ŒReleaseç‰ˆè¿è¡Œå¼‚å¸¸ã€‚ 
Thread 4:signal SIGABRT 
Stack buffer overflow detected

static void gen_key(int num, char key[]){
    if (num < 8 || key == NULL) {
        return;
    }
    if (num != 8) {
        num = 8;
    }
    
    char magic[] = "*Xj->aSr";
    
    memset(key, 127, num);
    
    for (int i = 0; i < num; ++i) {
        
        key[i] = abs((key[i] * magic[i]))%95 + 32;
    }
    return;
}
http://123.125.253.3/static/login.html

Today weâ€™re announcing our intention to merge Uber China with Didi Chuxing.


NSBundle *bundle = [NSBundle mainBundle];
    NSString* path = [bundle pathForResource:fileName ofType:KRecordToneFileEx inDirectory:kRecordTonePath];
    NSURL *musicUrl = [[NSURL alloc] initFileURLWithPath:path];
/var/containers/Bundle/Application/54EF45B0-7E31-4134-81C1-04B92A67BF79/DiSpecialDriver.app/DDASRClientResources/Tone/fristVoice.mp3
path:/var/containers/Bundle/Application/54EF45B0-7E31-4134-81C1-04B92A67BF79/DiSpecialDriver.app/DDASRClientResources/Tone/record_start.caf

14.æµ‹è¯•åœ°å€
NSURL *url = [NSURL URLWithString:item.url];
//    NSURL *url = [NSURL URLWithString:@"http://123.125.253.3/static/login.html"]; //æµ‹è¯•H5
2016-08-01 21:09:12.693 DiSpecialDriversDemo[358:40572] App Transport Security has blocked a cleartext HTTP (http://) resource load since it is insecure. Temporary exceptions can be configured via your app's Info.plist file.

15.æ­£å¸¸ç»“æŸ  [[DIDIVoiceRecognitionClient sharedInstance] speakFinish];
å–æ¶ˆ [[DIDIVoiceRecognitionClient sharedInstance] stopVoiceRecognition];
EVoiceRecognitionClientWorkStatusStart,                  // æ£€æµ‹åˆ°ç”¨æˆ·å¼€å§‹è¯´è¯
æ™šäºEVoiceRecognitionClientWorkStatusNewRecordData,          // å½•éŸ³æ•°æ®å›è°ƒ
